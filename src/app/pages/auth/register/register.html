<div
  class="max-w-md mx-auto mt-10 p-6 rounded md:bg-base-200 md:shadow animate-fade-in duration-200"
>
  <h2 class="text-2xl font-semibold mb-4">
    {{ "auth.register.title" | translate }}
  </h2>

  <form [formGroup]="registerForm" (ngSubmit)="register()">
    <div class="mt-3 mb-3">
      <app-text-input
        formControlName="userName"
        [label]="'auth.register.username' | translate"
      />

      @if (registerForm.get('userName')?.touched) { @if
      (registerForm.get('userName')?.hasError('minlength')) {
      <div class="animate-fade-in duration-100">
        <span
          [translate]="'validation.minlength'"
          [translateParams]="{
                requiredLength: registerForm.get('userName')?.errors?.['minlength']?.requiredLength,
                actualLength: registerForm.get('userName')?.errors?.['minlength']?.actualLength
              }"
          class="label-text-alt text-error"
        ></span>
      </div>
      } @if (registerForm.get('userName')?.hasError('maxlength')) {
      <div class="animate-fade-in duration-100">
        <span
          [translate]="'validation.maxlength'"
          [translateParams]="{
                requiredLength: registerForm.get('userName')?.errors?.['maxlength']?.requiredLength
              }"
          class="label-text-alt text-error"
        ></span>
      </div>
      } @if (registerForm.get('userName')?.hasError('latinOnly')) {
      <div class="animate-fade-in duration-100">
        <span class="label-text-alt text-error">
          {{ "validation.latinOnly" | translate }}</span
        >
      </div>
      } }@else {
      <div class="mt-1 text-xs opacity-70">
        {{ "auth.register.usernameHint" | translate }}
      </div>
      }
    </div>
    <div class="mb-2 mt-2">
      <app-text-input
        formControlName="email"
        [label]="'auth.register.email' | translate"
        type="email"
      />
      @if(registerForm.get('email')?.touched &&
      registerForm.get('email')?.hasError('email')) {

      <div class="animate-fade-in duration-100">
        <span class="label-text-alt text-error">
          {{ "validation.email" | translate }}</span
        >
      </div>
      }
    </div>
    <div class="mb-2 mt-2">
      <app-text-input
        formControlName="password"
        [label]="'auth.register.password' | translate"
        type="password"
      />
    </div>
    <div class="mt-2 mb-2">
      <app-text-input
        formControlName="confirmPassword"
        [label]="'auth.register.confirmPassword' | translate"
        type="password"
      />
      @if(registerForm.get('confirmPassword')?.touched &&
      registerForm.get('confirmPassword')?.hasError('mismatch')) {
      <div class="animate-fade-in duration-100">
        <span class="label-text-alt text-error">
          {{ "validation.passwordMismatch" | translate }}</span
        >
      </div>
      }
    </div>
    @if(errorMessages()){
    <div class="mt-3 p-3 bg-red-50 border border-red-200 rounded text-red-700">
      @for (error of errorMessages(); track $index) {
      <div>{{ error }}</div>
      }
    </div>
    }

    <button
      type="submit"
      class="w-full mt-4 btn btn-primary"
      [disabled]="registerForm.invalid || loading()"
    >
      @switch (loading()) { @case(true){
      <span class="loading loading-dots loading-lg"></span>
      }@case (false) {
      <span>{{ "auth.register.submit" | translate }}</span>
      } }
    </button>
  </form>
</div>
